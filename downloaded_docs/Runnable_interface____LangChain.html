<!DOCTYPE html>

<html class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-expression_language/interface" data-has-hydrated="false" dir="ltr" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="Docusaurus v2.4.3" name="generator"/>
<title data-rh="true">Runnable interface | ü¶úÔ∏èüîó LangChain</title><meta content="width=device-width,initial-scale=1" data-rh="true" name="viewport"/><meta content="summary_large_image" data-rh="true" name="twitter:card"/><meta content="https://python.langchain.com/v0.1/img/brand/theme-image.png" data-rh="true" property="og:image"/><meta content="https://python.langchain.com/v0.1/img/brand/theme-image.png" data-rh="true" name="twitter:image"/><meta content="https://python.langchain.com/v0.1/docs/expression_language/interface/" data-rh="true" property="og:url"/><meta content="en" data-rh="true" name="docusaurus_locale"/><meta content="en" data-rh="true" name="docsearch:language"/><meta content="current" data-rh="true" name="docusaurus_version"/><meta content="docs-default-current" data-rh="true" name="docusaurus_tag"/><meta content="current" data-rh="true" name="docsearch:version"/><meta content="docs-default-current" data-rh="true" name="docsearch:docusaurus_tag"/><meta content="Runnable interface | ü¶úÔ∏èüîó LangChain" data-rh="true" property="og:title"/><meta content="To make it as easy as possible to create custom chains, we've implemented a &quot;Runnable&quot; protocol. Many LangChain components implement the Runnable protocol, including chat models, LLMs, output parsers, retrievers, prompt templates, and more. There are also several useful primitives for working with runnables, which you can read about in this section." data-rh="true" name="description"/><meta content="To make it as easy as possible to create custom chains, we've implemented a &quot;Runnable&quot; protocol. Many LangChain components implement the Runnable protocol, including chat models, LLMs, output parsers, retrievers, prompt templates, and more. There are also several useful primitives for working with runnables, which you can read about in this section." data-rh="true" property="og:description"/><link data-rh="true" href="/v0.1/img/brand/favicon.png" rel="icon"/><link data-rh="true" href="https://python.langchain.com/v0.1/docs/expression_language/interface/" hreflang="en" rel="alternate"/><link data-rh="true" href="https://python.langchain.com/v0.1/docs/expression_language/interface/" hreflang="x-default" rel="alternate"/><link crossorigin="anonymous" data-rh="true" href="https://VAU016LAWS-dsn.algolia.net" rel="preconnect"/><link data-rh="true" href="https://python.langchain.com/v0.2/docs/how_to/lcel_cheatsheet/" rel="canonical"/><link href="/v0.1/opensearch.xml" rel="search" title="ü¶úÔ∏èüîó LangChain" type="application/opensearchdescription+xml"/>
<script src="/v0.1/js/google_analytics.js"></script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9B66JQQH2F"></script><link href="/v0.1/assets/css/styles.0976af24.css" rel="stylesheet"/>
<link as="script" href="/v0.1/assets/js/runtime~main.1b0b4a9b.js" rel="preload"/>
<link as="script" href="/v0.1/assets/js/main.1470d8ce.js" rel="preload"/>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div aria-label="Skip to main content" role="region"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">LangChain v0.2 is out! You are currently viewing the old v0.1 docs. <strong>View the latest docs <a href="/v0.2/docs/introduction/">here</a>.</strong></div><button aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7" type="button"><svg height="14" viewbox="0 0 15 15" width="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-expanded="false" aria-label="Toggle navigation bar" class="navbar__toggle clean-btn" type="button"><svg aria-hidden="true" height="30" viewbox="0 0 30 30" width="30"><path d="M4 7h22M4 15h22M4 23h22" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"></path></svg></button><a class="navbar__brand" href="/v0.1/"><div class="navbar__logo"><img alt="ü¶úÔ∏èüîó LangChain" class="themedImage_ToTc themedImage--light_HNdA" src="/v0.1/img/brand/wordmark.png"/><img alt="ü¶úÔ∏èüîó LangChain" class="themedImage_ToTc themedImage--dark_i4oU" src="/v0.1/img/brand/wordmark-dark.png"/></div></a><a class="navbar__item navbar__link" href="/v0.1/docs/modules/">Components</a><a class="navbar__item navbar__link" href="/v0.1/docs/integrations/platforms/">Integrations</a><a class="navbar__item navbar__link" href="/v0.1/docs/guides/">Guides</a><a class="navbar__item navbar__link" href="https://api.python.langchain.com/en/v0.1/" rel="noopener noreferrer" target="_blank">API Reference<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-expanded="false" aria-haspopup="true" class="navbar__link" href="#" role="button">More</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/v0.1/docs/people/">People</a></li><li><a class="dropdown__link" href="/v0.1/docs/packages/">Versioning</a></li><li><a class="dropdown__link" href="/v0.1/docs/contributing/">Contributing</a></li><li><a class="dropdown__link" href="/v0.1/docs/templates/">Templates</a></li><li><a class="dropdown__link" href="https://github.com/langchain-ai/langchain/blob/master/cookbook/README.md" rel="noopener noreferrer" target="_blank">Cookbooks<svg aria-hidden="true" class="iconExternalLink_nPIU" height="12" viewbox="0 0 24 24" width="12"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li><a class="dropdown__link" href="/v0.1/docs/additional_resources/tutorials/">Tutorials</a></li><li><a class="dropdown__link" href="/v0.1/docs/additional_resources/youtube/">YouTube</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-expanded="false" aria-haspopup="true" class="navbar__link" href="#" role="button">v0.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="https://python.langchain.com/v0.2/docs/introduction" rel="noopener noreferrer" target="_blank">v0.2<svg aria-hidden="true" class="iconExternalLink_nPIU" height="12" viewbox="0 0 24 24" width="12"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li><a class="dropdown__link" href="/v0.1/docs/get_started/introduction/">v0.1</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-expanded="false" aria-haspopup="true" class="navbar__link" href="#" role="button">ü¶úÔ∏èüîó</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="https://smith.langchain.com" rel="noopener noreferrer" target="_blank">LangSmith<svg aria-hidden="true" class="iconExternalLink_nPIU" height="12" viewbox="0 0 24 24" width="12"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li><a class="dropdown__link" href="https://docs.smith.langchain.com/" rel="noopener noreferrer" target="_blank">LangSmith Docs<svg aria-hidden="true" class="iconExternalLink_nPIU" height="12" viewbox="0 0 24 24" width="12"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li><a class="dropdown__link" href="https://github.com/langchain-ai/langserve" rel="noopener noreferrer" target="_blank">LangServe GitHub<svg aria-hidden="true" class="iconExternalLink_nPIU" height="12" viewbox="0 0 24 24" width="12"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li><a class="dropdown__link" href="https://github.com/langchain-ai/langchain/tree/master/templates" rel="noopener noreferrer" target="_blank">Templates GitHub<svg aria-hidden="true" class="iconExternalLink_nPIU" height="12" viewbox="0 0 24 24" width="12"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li><a class="dropdown__link" href="https://templates.langchain.com" rel="noopener noreferrer" target="_blank">Templates Hub<svg aria-hidden="true" class="iconExternalLink_nPIU" height="12" viewbox="0 0 24 24" width="12"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li><a class="dropdown__link" href="https://smith.langchain.com/hub" rel="noopener noreferrer" target="_blank">LangChain Hub<svg aria-hidden="true" class="iconExternalLink_nPIU" height="12" viewbox="0 0 24 24" width="12"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li><a class="dropdown__link" href="https://js.langchain.com" rel="noopener noreferrer" target="_blank">JS/TS Docs<svg aria-hidden="true" class="iconExternalLink_nPIU" height="12" viewbox="0 0 24 24" width="12"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li></ul></div><a class="navbar__item navbar__link" href="https://chat.langchain.com" rel="noopener noreferrer" target="_blank">üí¨<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a><a aria-label="GitHub repository" class="navbar__item navbar__link header-github-link" href="https://github.com/langchain-ai/langchain" rel="noopener noreferrer" target="_blank"></a><div class="toggle_vylO colorModeToggle_DEke"><button aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" disabled="" title="Switch between dark and light mode (currently light mode)" type="button"><svg class="lightToggleIcon_pyhR" height="24" viewbox="0 0 24 24" width="24"><path d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z" fill="currentColor"></path></svg><svg class="darkToggleIcon_wfgR" height="24" viewbox="0 0 24 24" width="24"><path d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z" fill="currentColor"></path></svg></button></div><div class="searchBox_ZlJk"><button aria-label="Search" class="DocSearch DocSearch-Button" type="button"><span class="DocSearch-Button-Container"><svg aria-hidden="true" class="DocSearch-Search-Icon" height="20" viewbox="0 0 20 20" width="20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div class="navbar-sidebar__backdrop" role="presentation"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX" id="__docusaurus_skipToContent_fallback"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/v0.1/docs/get_started/introduction/">Get started</a></div><ul class="menu__list" style="display:block;overflow:visible;height:auto"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item hidden"><a class="menu__link" href="/v0.1/docs/get_started/introduction/" tabindex="0">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/v0.1/docs/get_started/quickstart/" tabindex="0">Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/v0.1/docs/get_started/installation/" tabindex="0">Installation</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/v0.1/docs/use_cases/">Use cases</a></div><ul class="menu__list" style="display:block;overflow:visible;height:auto"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist" href="/v0.1/docs/use_cases/question_answering/" tabindex="0">Q&amp;A with RAG</a><button aria-label="Toggle the collapsible sidebar category 'Q&amp;A with RAG'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist" href="/v0.1/docs/use_cases/extraction/" tabindex="0">Extracting structured output</a><button aria-label="Toggle the collapsible sidebar category 'Extracting structured output'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist" href="/v0.1/docs/use_cases/chatbots/" tabindex="0">Chatbots</a><button aria-label="Toggle the collapsible sidebar category 'Chatbots'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist" href="/v0.1/docs/use_cases/tool_use/" tabindex="0">Tool use and agents</a><button aria-label="Toggle the collapsible sidebar category 'Tool use and agents'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist" href="/v0.1/docs/use_cases/query_analysis/" tabindex="0">Query analysis</a><button aria-label="Toggle the collapsible sidebar category 'Query analysis'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist" href="/v0.1/docs/use_cases/sql/" tabindex="0">Q&amp;A over SQL + CSV</a><button aria-label="Toggle the collapsible sidebar category 'Q&amp;A over SQL + CSV'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist menu__link--sublist-caret" href="/v0.1/docs/use_cases/graph/" tabindex="0">More</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/v0.1/docs/expression_language/">Expression Language</a></div><ul class="menu__list" style="display:block;overflow:visible;height:auto"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/v0.1/docs/expression_language/get_started/" tabindex="0">Get started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/v0.1/docs/expression_language/interface/" tabindex="0">Runnable interface</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist" href="/v0.1/docs/expression_language/primitives/" tabindex="0">Primitives</a><button aria-label="Toggle the collapsible sidebar category 'Primitives'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/v0.1/docs/expression_language/why/" tabindex="0">Advantages of LCEL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/v0.1/docs/expression_language/streaming/" tabindex="0">Streaming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/v0.1/docs/expression_language/how_to/message_history/" tabindex="0">Add message history (memory)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist menu__link--sublist-caret" href="/v0.1/docs/expression_language/how_to/routing/" tabindex="0">More</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Ecosystem</a></div><ul class="menu__list" style="display:block;overflow:visible;height:auto"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a aria-expanded="false" class="menu__link menu__link--sublist" href="/v0.1/docs/langsmith/" tabindex="0">ü¶úüõ†Ô∏è LangSmith</a><button aria-label="Toggle the collapsible sidebar category 'ü¶úüõ†Ô∏è LangSmith'" class="clean-btn menu__caret" type="button"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menuExternalLink_NmtK" href="https://langchain-ai.github.io/langgraph/" rel="noopener noreferrer" tabindex="0" target="_blank">ü¶úüï∏Ô∏è LangGraph<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" href="/v0.1/docs/langserve/" tabindex="0">ü¶úÔ∏èüèì LangServe</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v0.1/docs/security/">Security</a></li></ul></nav><button aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL" title="Collapse sidebar" type="button"><svg aria-hidden="true" class="collapseSidebarButtonIcon_kv0_" height="20" width="20"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav aria-label="Breadcrumbs" class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/v0.1/"><svg class="breadcrumbHomeIcon_YNFT" viewbox="0 0 24 24"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item" itemprop="itemListElement" itemscope="" itemtype="https://schema.org/ListItem"><a class="breadcrumbs__link" href="/v0.1/docs/expression_language/" itemprop="item"><span itemprop="name">Expression Language</span></a><meta content="1" itemprop="position"/></li><li class="breadcrumbs__item breadcrumbs__item--active" itemprop="itemListElement" itemscope="" itemtype="https://schema.org/ListItem"><span class="breadcrumbs__link" itemprop="name">Runnable interface</span><meta content="2" itemprop="position"/></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button class="clean-btn tocCollapsibleButton_TO0P" type="button">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Runnable interface</h1></header><p>To make it as easy as possible to create custom chains, we've implemented a <a href="https://api.python.langchain.com/en/stable/runnables/langchain_core.runnables.base.Runnable.html#langchain_core.runnables.base.Runnable" rel="noopener noreferrer" target="_blank">"Runnable"</a> protocol. Many LangChain components implement the <code>Runnable</code> protocol, including chat models, LLMs, output parsers, retrievers, prompt templates, and more. There are also several useful primitives for working with runnables, which you can read about <a href="/v0.1/docs/expression_language/primitives/">in this section</a>.</p><p>This is a standard interface, which makes it easy to define custom chains as well as invoke them in a standard way.
The standard interface includes:</p><ul><li><a href="#stream"><code>stream</code></a>: stream back chunks of the response</li><li><a href="#invoke"><code>invoke</code></a>: call the chain on an input</li><li><a href="#batch"><code>batch</code></a>: call the chain on a list of inputs</li></ul><p>These also have corresponding async methods that should be used with <a href="https://docs.python.org/3/library/asyncio.html" rel="noopener noreferrer" target="_blank">asyncio</a> <code>await</code> syntax for concurrency:</p><ul><li><a href="#async-stream"><code>astream</code></a>: stream back chunks of the response async</li><li><a href="#async-invoke"><code>ainvoke</code></a>: call the chain on an input async</li><li><a href="#async-batch"><code>abatch</code></a>: call the chain on a list of inputs async</li><li><a href="#async-stream-intermediate-steps"><code>astream_log</code></a>: stream back intermediate steps as they happen, in addition to the final response</li><li><a href="#async-stream-events"><code>astream_events</code></a>: <strong>beta</strong> stream events as they happen in the chain (introduced in <code>langchain-core</code> 0.1.14)</li></ul><p>The <strong>input type</strong> and <strong>output type</strong> varies by component:</p><table><thead><tr><th>Component</th><th>Input Type</th><th>Output Type</th></tr></thead><tbody><tr><td>Prompt</td><td>Dictionary</td><td>PromptValue</td></tr><tr><td>ChatModel</td><td>Single string, list of chat messages or a PromptValue</td><td>ChatMessage</td></tr><tr><td>LLM</td><td>Single string, list of chat messages or a PromptValue</td><td>String</td></tr><tr><td>OutputParser</td><td>The output of an LLM or ChatModel</td><td>Depends on the parser</td></tr><tr><td>Retriever</td><td>Single string</td><td>List of Documents</td></tr><tr><td>Tool</td><td>Single string or dictionary, depending on the tool</td><td>Depends on the tool</td></tr></tbody></table><p>All runnables expose input and output <strong>schemas</strong> to inspect the inputs and outputs:</p><ul><li><a href="#input-schema"><code>input_schema</code></a>: an input Pydantic model auto-generated from the structure of the Runnable</li><li><a href="#output-schema"><code>output_schema</code></a>: an output Pydantic model auto-generated from the structure of the Runnable</li></ul><p>Let's take a look at these methods. To do so, we'll create a super simple PromptTemplate + ChatModel chain.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain">pip install </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">upgrade </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">quiet  langchain</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">core langchain</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">community langchain</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">openai</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_core</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">prompts </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> ChatPromptTemplate</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_openai </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> ChatOpenAI</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">model </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ChatOpenAI</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">prompt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ChatPromptTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_template</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"tell me a joke about {topic}"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> prompt </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> model</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div style="padding-top:1.3rem;background:var(--prism-background-color);color:var(--prism-color);margin-top:calc(-1 * var(--ifm-leading) - 5px);margin-bottom:var(--ifm-leading);box-shadow:var(--ifm-global-shadow-lw);border-bottom-left-radius:var(--ifm-code-border-radius);border-bottom-right-radius:var(--ifm-code-border-radius)"><h4 style="padding-left:0.65rem;margin-bottom:0.45rem">API Reference:</h4><ul style="padding-bottom:1rem"><li><a href="https://api.python.langchain.com/en/latest/prompts/langchain_core.prompts.chat.ChatPromptTemplate.html"><span>ChatPromptTemplate</span></a></li><li><a href="https://api.python.langchain.com/en/latest/chat_models/langchain_openai.chat_models.base.ChatOpenAI.html"><span>ChatOpenAI</span></a></li></ul></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="input-schema">Input Schema<a aria-label="Direct link to Input Schema" class="hash-link" href="#input-schema" title="Direct link to Input Schema">‚Äã</a></h2><p>A description of the inputs accepted by a Runnable.
This is a Pydantic model dynamically generated from the structure of any Runnable.
You can call <code>.schema()</code> on it to obtain a JSONSchema representation.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># The input schema of the chain is the input schema of its first part, the prompt.</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">input_schema</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">{'title': 'PromptInput',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'properties': {'topic': {'title': 'Topic', 'type': 'string'}}}</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">prompt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">input_schema</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">{'title': 'PromptInput',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'properties': {'topic': {'title': 'Topic', 'type': 'string'}}}</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">model</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">input_schema</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">{'title': 'ChatOpenAIInput',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  {'$ref': '#/definitions/StringPromptValue'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  {'$ref': '#/definitions/ChatPromptValueConcrete'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'items': {'anyOf': [{'$ref': '#/definitions/AIMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     {'$ref': '#/definitions/HumanMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     {'$ref': '#/definitions/ChatMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     {'$ref': '#/definitions/SystemMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     {'$ref': '#/definitions/FunctionMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     {'$ref': '#/definitions/ToolMessage'}]}}],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'definitions': {'StringPromptValue': {'title': 'StringPromptValue',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'String prompt value.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'text': {'title': 'Text', 'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'StringPromptValue',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['StringPromptValue'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['text']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'AIMessage': {'title': 'AIMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message from an AI.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'ai',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['ai'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'example': {'title': 'Example', 'default': False, 'type': 'boolean'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'HumanMessage': {'title': 'HumanMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message from a human.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'human',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['human'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'example': {'title': 'Example', 'default': False, 'type': 'boolean'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'ChatMessage': {'title': 'ChatMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message that can be assigned an arbitrary speaker (i.e. role).',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'chat',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['chat'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'role': {'title': 'Role', 'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content', 'role']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'SystemMessage': {'title': 'SystemMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message for priming AI behavior, usually passed in as the first of a sequence\nof input messages.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'system',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['system'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'FunctionMessage': {'title': 'FunctionMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message for passing the result of executing a function back to a model.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'function',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['function'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'name': {'title': 'Name', 'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content', 'name']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'ToolMessage': {'title': 'ToolMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message for passing the result of executing a tool back to a model.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'tool',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['tool'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'tool_call_id': {'title': 'Tool Call Id', 'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content', 'tool_call_id']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'ChatPromptValueConcrete': {'title': 'ChatPromptValueConcrete',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'Chat prompt value which explicitly lists out the message types it accepts.\nFor use in external schemas.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'messages': {'title': 'Messages',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'items': {'anyOf': [{'$ref': '#/definitions/AIMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       {'$ref': '#/definitions/HumanMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       {'$ref': '#/definitions/ChatMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       {'$ref': '#/definitions/SystemMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       {'$ref': '#/definitions/FunctionMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       {'$ref': '#/definitions/ToolMessage'}]}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'ChatPromptValueConcrete',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['ChatPromptValueConcrete'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['messages']}}}</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="output-schema">Output Schema<a aria-label="Direct link to Output Schema" class="hash-link" href="#output-schema" title="Direct link to Output Schema">‚Äã</a></h2><p>A description of the outputs produced by a Runnable.
This is a Pydantic model dynamically generated from the structure of any Runnable.
You can call <code>.schema()</code> on it to obtain a JSONSchema representation.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"># The output schema of the chain is the output schema of its last part, in this case a ChatModel, which outputs a ChatMessage</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">output_schema</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">{'title': 'ChatOpenAIOutput',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'anyOf': [{'$ref': '#/definitions/AIMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  {'$ref': '#/definitions/HumanMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  {'$ref': '#/definitions/ChatMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  {'$ref': '#/definitions/SystemMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  {'$ref': '#/definitions/FunctionMessage'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  {'$ref': '#/definitions/ToolMessage'}],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'definitions': {'AIMessage': {'title': 'AIMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message from an AI.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'ai',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['ai'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'example': {'title': 'Example', 'default': False, 'type': 'boolean'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'HumanMessage': {'title': 'HumanMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message from a human.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'human',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['human'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'example': {'title': 'Example', 'default': False, 'type': 'boolean'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'ChatMessage': {'title': 'ChatMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message that can be assigned an arbitrary speaker (i.e. role).',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'chat',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['chat'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'role': {'title': 'Role', 'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content', 'role']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'SystemMessage': {'title': 'SystemMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message for priming AI behavior, usually passed in as the first of a sequence\nof input messages.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'system',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['system'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'FunctionMessage': {'title': 'FunctionMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message for passing the result of executing a function back to a model.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'function',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['function'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'name': {'title': 'Name', 'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content', 'name']},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'ToolMessage': {'title': 'ToolMessage',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'description': 'A Message for passing the result of executing a tool back to a model.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'type': 'object',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'properties': {'content': {'title': 'Content',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'anyOf': [{'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">      {'type': 'array',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">       'items': {'anyOf': [{'type': 'string'}, {'type': 'object'}]}}]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'additional_kwargs': {'title': 'Additional Kwargs', 'type': 'object'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'type': {'title': 'Type',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'default': 'tool',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'enum': ['tool'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">     'type': 'string'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    'tool_call_id': {'title': 'Tool Call Id', 'type': 'string'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">   'required': ['content', 'tool_call_id']}}}</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stream">Stream<a aria-label="Direct link to Stream" class="hash-link" href="#stream" title="Direct link to Stream">‚Äã</a></h2><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> s </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">stream</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> end</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">""</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> flush</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Sure, here's a bear-themed joke for you:</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Why don't bears wear shoes?</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Because they already have bear feet!</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="invoke">Invoke<a aria-label="Direct link to Invoke" class="hash-link" href="#invoke" title="Direct link to Invoke">‚Äã</a></h2><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">invoke</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">AIMessage(content="Why don't bears wear shoes? \n\nBecause they have bear feet!")</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="batch">Batch<a aria-label="Direct link to Batch" class="hash-link" href="#batch" title="Direct link to Batch">‚Äã</a></h2><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">batch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"cats"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[AIMessage(content="Sure, here's a bear joke for you:\n\nWhy don't bears wear shoes?\n\nBecause they already have bear feet!"),</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> AIMessage(content="Why don't cats play poker in the wild?\n\nToo many cheetahs!")]</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><p>You can set the number of concurrent requests by using the <code>max_concurrency</code> parameter</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">batch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"cats"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> config</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"max_concurrency"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[AIMessage(content="Why don't bears wear shoes?\n\nBecause they have bear feet!"),</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> AIMessage(content="Why don't cats play poker in the wild? Too many cheetahs!")]</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="async-stream">Async Stream<a aria-label="Direct link to Async Stream" class="hash-link" href="#async-stream" title="Direct link to Async Stream">‚Äã</a></h2><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> s </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">astream</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> end</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">""</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> flush</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Why don't bears wear shoes?</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Because they have bear feet!</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="async-invoke">Async Invoke<a aria-label="Direct link to Async Invoke" class="hash-link" href="#async-invoke" title="Direct link to Async Invoke">‚Äã</a></h2><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ainvoke</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">AIMessage(content="Why don't bears ever wear shoes?\n\nBecause they already have bear feet!")</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="async-batch">Async Batch<a aria-label="Direct link to Async Batch" class="hash-link" href="#async-batch" title="Direct link to Async Batch">‚Äã</a></h2><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">abatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[AIMessage(content="Why don't bears wear shoes?\n\nBecause they have bear feet!")]</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="async-stream-events-beta">Async Stream Events (beta)<a aria-label="Direct link to Async Stream Events (beta)" class="hash-link" href="#async-stream-events-beta" title="Direct link to Async Stream Events (beta)">‚Äã</a></h2><p>Event Streaming is a <strong>beta</strong> API, and may change a bit based on feedback.</p><p>Note: Introduced in langchain-core 0.2.0</p><p>For now, when using the astream_events API, for everything to work properly please:</p><ul><li>Use <code>async</code> throughout the code (including async tools etc)</li><li>Propagate callbacks if defining custom functions / runnables. </li><li>Whenever using runnables without LCEL, make sure to call <code>.astream()</code> on LLMs rather than <code>.ainvoke</code> to force the LLM to stream tokens.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-reference">Event Reference<a aria-label="Direct link to Event Reference" class="hash-link" href="#event-reference" title="Direct link to Event Reference">‚Äã</a></h3><p>Here is a reference table that shows some events that might be emitted by the various Runnable objects.
Definitions for some of the Runnable are included after the table.</p><p>‚ö†Ô∏è When streaming the inputs for the runnable will not be available until the input stream has been entirely consumed This means that the inputs will be available at for the corresponding <code>end</code> hook rather than <code>start</code> event.</p><table><thead><tr><th>event</th><th>name</th><th>chunk</th><th>input</th><th>output</th></tr></thead><tbody><tr><td>on_chat_model_start</td><td>[model name]</td><td></td><td>{"messages": [<!-- -->[SystemMessage, HumanMessage]<!-- -->]}</td><td></td></tr><tr><td>on_chat_model_stream</td><td>[model name]</td><td>AIMessageChunk(content="hello")</td><td></td><td></td></tr><tr><td>on_chat_model_end</td><td>[model name]</td><td></td><td>{"messages": [<!-- -->[SystemMessage, HumanMessage]<!-- -->]}</td><td>{"generations": <!-- -->[...]<!-- -->, "llm_output": None, ...}</td></tr><tr><td>on_llm_start</td><td>[model name]</td><td></td><td>{'input': 'hello'}</td><td></td></tr><tr><td>on_llm_stream</td><td>[model name]</td><td>'Hello'</td><td></td><td></td></tr><tr><td>on_llm_end</td><td>[model name]</td><td></td><td>'Hello human!'</td><td></td></tr><tr><td>on_chain_start</td><td>format_docs</td><td></td><td></td><td></td></tr><tr><td>on_chain_stream</td><td>format_docs</td><td>"hello world!, goodbye world!"</td><td></td><td></td></tr><tr><td>on_chain_end</td><td>format_docs</td><td></td><td>[Document(...)]</td><td>"hello world!, goodbye world!"</td></tr><tr><td>on_tool_start</td><td>some_tool</td><td></td><td>{"x": 1, "y": "2"}</td><td></td></tr><tr><td>on_tool_stream</td><td>some_tool</td><td>{"x": 1, "y": "2"}</td><td></td><td></td></tr><tr><td>on_tool_end</td><td>some_tool</td><td></td><td></td><td>{"x": 1, "y": "2"}</td></tr><tr><td>on_retriever_start</td><td>[retriever name]</td><td></td><td>{"query": "hello"}</td><td></td></tr><tr><td>on_retriever_chunk</td><td>[retriever name]</td><td>{documents: <!-- -->[...]<!-- -->}</td><td></td><td></td></tr><tr><td>on_retriever_end</td><td>[retriever name]</td><td></td><td>{"query": "hello"}</td><td>{documents: <!-- -->[...]<!-- -->}</td></tr><tr><td>on_prompt_start</td><td>[template_name]</td><td></td><td>{"question": "hello"}</td><td></td></tr><tr><td>on_prompt_end</td><td>[template_name]</td><td></td><td>{"question": "hello"}</td><td>ChatPromptValue(messages: <!-- -->[SystemMessage, ...]<!-- -->)</td></tr></tbody></table><p>Here are declarations associated with the events shown above:</p><p><code>format_docs</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">format_docs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">docs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">Document</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">'''Format the docs.'''</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">", "</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">doc</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">page_content </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> doc </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> docs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">format_docs </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> RunnableLambda</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">format_docs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><p><code>some_tool</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token decorator annotation punctuation" style="color:rgb(4, 81, 165)">@tool</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">some_tool</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">int</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">dict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">'''Some_tool.'''</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"x"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"y"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><p><code>prompt</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">template </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ChatPromptTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_messages</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"system"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"You are Cat Agent 007"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"human"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"{question}"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">with_config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"run_name"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"my_template"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"tags"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"my_template"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><p>Let's define a new chain to make it more interesting to show off the <code>astream_events</code> interface (and later the <code>astream_log</code> interface).</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_community</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">vectorstores </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> FAISS</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_core</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">output_parsers </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> StrOutputParser</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_core</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">runnables </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> RunnablePassthrough</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_openai </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> OpenAIEmbeddings</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">template </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""Answer the question based only on the following context:</span><br/></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">{context}</span><br/></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(163, 21, 21)"></span><br/></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">Question: {question}</span><br/></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">prompt </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ChatPromptTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_template</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">template</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">vectorstore </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> FAISS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_texts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"harrison worked at kensho"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> embedding</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">OpenAIEmbeddings</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">retriever </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> vectorstore</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">as_retriever</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">retrieval_chain </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token string" style="color:rgb(163, 21, 21)">"context"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> retriever</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">with_config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">run_name</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"Docs"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token string" style="color:rgb(163, 21, 21)">"question"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> RunnablePassthrough</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> prompt</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">with_config</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">run_name</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"my_llm"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> StrOutputParser</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div style="padding-top:1.3rem;background:var(--prism-background-color);color:var(--prism-color);margin-top:calc(-1 * var(--ifm-leading) - 5px);margin-bottom:var(--ifm-leading);box-shadow:var(--ifm-global-shadow-lw);border-bottom-left-radius:var(--ifm-code-border-radius);border-bottom-right-radius:var(--ifm-code-border-radius)"><h4 style="padding-left:0.65rem;margin-bottom:0.45rem">API Reference:</h4><ul style="padding-bottom:1rem"><li><a href="https://api.python.langchain.com/en/latest/vectorstores/langchain_community.vectorstores.faiss.FAISS.html"><span>FAISS</span></a></li><li><a href="https://api.python.langchain.com/en/latest/output_parsers/langchain_core.output_parsers.string.StrOutputParser.html"><span>StrOutputParser</span></a></li><li><a href="https://api.python.langchain.com/en/latest/runnables/langchain_core.runnables.passthrough.RunnablePassthrough.html"><span>RunnablePassthrough</span></a></li><li><a href="https://api.python.langchain.com/en/latest/embeddings/langchain_openai.embeddings.base.OpenAIEmbeddings.html"><span>OpenAIEmbeddings</span></a></li></ul></div><p>Now let's use <code>astream_events</code> to get events from the retriever and the LLM.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> event </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> retrieval_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">astream_events</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">"where did harrison work?"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> version</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"v1"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> include_names</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"Docs"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"my_llm"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    kind </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"event"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> kind </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"on_chat_model_stream"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"data"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"chunk"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> end</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"|"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">elif</span><span class="token plain"> kind </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"on_chat_model_start"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"Streaming LLM:"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">elif</span><span class="token plain"> kind </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"on_chat_model_end"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"Done streaming LLM."</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">elif</span><span class="token plain"> kind </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"on_retriever_end"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"--"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"Retrieved the following documents:"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"data"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"output"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"documents"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">elif</span><span class="token plain"> kind </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"on_tool_end"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string-interpolation string" style="color:rgb(163, 21, 21)">f"Ended tool: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string-interpolation interpolation">event</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string-interpolation interpolation string" style="color:rgb(163, 21, 21)">'name'</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token string-interpolation string" style="color:rgb(163, 21, 21)">"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">pass</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">/home/eugene/src/langchain/libs/core/langchain_core/_api/beta_decorator.py:86: LangChainBetaWarning: This API is in beta and may change in the future.</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  warn_beta(</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">``````output</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">--</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Retrieved the following documents:</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">[Document(page_content='harrison worked at kensho')]</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Streaming LLM:</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">|H|arrison| worked| at| Kens|ho|.||</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Done streaming LLM.</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="async-stream-intermediate-steps">Async Stream Intermediate Steps<a aria-label="Direct link to Async Stream Intermediate Steps" class="hash-link" href="#async-stream-intermediate-steps" title="Direct link to Async Stream Intermediate Steps">‚Äã</a></h2><p>All runnables also have a method <code>.astream_log()</code> which is used to stream (as they happen) all or part of the intermediate steps of your chain/sequence. </p><p>This is useful to show progress to the user, to use intermediate results, or to debug your chain.</p><p>You can stream all steps (default) or include/exclude steps by name, tags or metadata.</p><p>This method yields <a href="https://jsonpatch.com" rel="noopener noreferrer" target="_blank">JSONPatch</a> ops that when applied in the same order as received build up the RunState.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">LogEntry</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">TypedDict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token builtin" style="color:rgb(0, 112, 193)">id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""ID of the sub-run."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""Name of the object being run."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token builtin" style="color:rgb(0, 112, 193)">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""Type of the object being run, eg. prompt, chain, llm, etc."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    tags</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""List of tags for the run."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    metadata</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""Key-value pairs of metadata for the run."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    start_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""ISO-8601 timestamp of when the run started."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    streamed_output_str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""List of LLM tokens streamed by this run, if applicable."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    final_output</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">Any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""Final output of this run.</span><br/></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    Only available after the run has finished successfully."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    end_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""ISO-8601 timestamp of when the run ended.</span><br/></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    Only available after the run has finished."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">RunState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">TypedDict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token builtin" style="color:rgb(0, 112, 193)">id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""ID of the run."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    streamed_output</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">Any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""List of output chunks streamed by Runnable.stream()"""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    final_output</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">Any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""Final output of the run, usually the result of aggregating (`+`) streamed_output.</span><br/></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    Only available after the run has finished successfully."""</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    logs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token builtin" style="color:rgb(0, 112, 193)">str</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> LogEntry</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">"""Map of run names to sub-runs. If filters were supplied, this list will</span><br/></span><span class="token-line" style="color:#000000"><span class="token triple-quoted-string string" style="color:rgb(163, 21, 21)">    contain only the runs that matched the filters."""</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="streaming-jsonpatch-chunks">Streaming JSONPatch chunks<a aria-label="Direct link to Streaming JSONPatch chunks" class="hash-link" href="#streaming-jsonpatch-chunks" title="Direct link to Streaming JSONPatch chunks">‚Äã</a></h3><p>This is useful eg. to stream the <code>JSONPatch</code> in an HTTP server, and then apply the ops on the client to rebuild the run state there. See <a href="https://github.com/langchain-ai/langserve" rel="noopener noreferrer" target="_blank">LangServe</a> for tooling to make it easier to build a webserver from any Runnable.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> chunk </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> retrieval_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">astream_log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">"where did harrison work?"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> include_names</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"Docs"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"-"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">40</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">chunk</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'replace',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'path': '',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'value': {'final_output': None,</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'id': '82e9b4b1-3dd6-4732-8db9-90e79c4da48c',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'logs': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'type': 'chain'}})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'path': '/logs/Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'value': {'end_time': None,</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'final_output': None,</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'id': '9206e94a-57bd-48ee-8c5e-fdd1c52a6da2',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'start_time': '2024-01-19T22:33:55.902+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">            'type': 'retriever'}})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'path': '/logs/Docs/final_output',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'value': {'documents': [Document(page_content='harrison worked at kensho')]}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'op': 'add',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'path': '/logs/Docs/end_time',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'value': '2024-01-19T22:33:56.064+00:00'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add', 'path': '/streamed_output/-', 'value': ''},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'op': 'replace', 'path': '/final_output', 'value': ''})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add', 'path': '/streamed_output/-', 'value': 'H'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'op': 'replace', 'path': '/final_output', 'value': 'H'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add', 'path': '/streamed_output/-', 'value': 'arrison'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'op': 'replace', 'path': '/final_output', 'value': 'Harrison'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add', 'path': '/streamed_output/-', 'value': ' worked'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'op': 'replace', 'path': '/final_output', 'value': 'Harrison worked'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add', 'path': '/streamed_output/-', 'value': ' at'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'op': 'replace', 'path': '/final_output', 'value': 'Harrison worked at'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add', 'path': '/streamed_output/-', 'value': ' Kens'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'op': 'replace', 'path': '/final_output', 'value': 'Harrison worked at Kens'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add', 'path': '/streamed_output/-', 'value': 'ho'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'op': 'replace',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'path': '/final_output',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'value': 'Harrison worked at Kensho'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add', 'path': '/streamed_output/-', 'value': '.'},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'op': 'replace',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'path': '/final_output',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'value': 'Harrison worked at Kensho.'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLogPatch({'op': 'add', 'path': '/streamed_output/-', 'value': ''})</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="streaming-the-incremental-runstate">Streaming the incremental RunState<a aria-label="Direct link to Streaming the incremental RunState" class="hash-link" href="#streaming-the-incremental-runstate" title="Direct link to Streaming the incremental RunState">‚Äã</a></h3><p>You can simply pass <code>diff=False</code> to get incremental values of <code>RunState</code>.
You get more verbose output with more repetitive parts.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> chunk </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> retrieval_chain</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">astream_log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">"where did harrison work?"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> include_names</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"Docs"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> diff</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token boolean">False</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"-"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">70</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">print</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">chunk</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': None,</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': None,</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': None,</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': None,</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': None,</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': '',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': [''],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': 'H',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': ['', 'H'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': 'Harrison',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': ['', 'H', 'arrison'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': 'Harrison worked',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': ['', 'H', 'arrison', ' worked'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': 'Harrison worked at',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': ['', 'H', 'arrison', ' worked', ' at'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': 'Harrison worked at Kens',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': ['', 'H', 'arrison', ' worked', ' at', ' Kens'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': 'Harrison worked at Kensho',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': ['', 'H', 'arrison', ' worked', ' at', ' Kens', 'ho'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': 'Harrison worked at Kensho.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': ['', 'H', 'arrison', ' worked', ' at', ' Kens', 'ho', '.'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">----------------------------------------------------------------------</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">RunLog({'final_output': 'Harrison worked at Kensho.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'id': '431d1c55-7c50-48ac-b3a2-2f5ba5f35172',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'logs': {'Docs': {'end_time': '2024-01-19T22:33:57.120+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'final_output': {'documents': [Document(page_content='harrison worked at kensho')]},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'id': '8de10b49-d6af-4cb7-a4e7-fbadf6efa01e',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'metadata': {},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'name': 'Docs',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'start_time': '2024-01-19T22:33:56.939+00:00',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'streamed_output_str': [],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'tags': ['map:key:context', 'FAISS', 'OpenAIEmbeddings'],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                   'type': 'retriever'}},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'name': 'RunnableSequence',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'streamed_output': ['',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                     'H',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                     'arrison',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                     ' worked',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                     ' at',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                     ' Kens',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                     'ho',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                     '.',</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">                     ''],</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'type': 'chain'})</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="parallelism">Parallelism<a aria-label="Direct link to Parallelism" class="hash-link" href="#parallelism" title="Direct link to Parallelism">‚Äã</a></h2><p>Let's take a look at how LangChain Expression Language supports parallel requests.
For example, when using a <code>RunnableParallel</code> (often written as a dictionary) it executes each element in parallel.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> langchain_core</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">runnables </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> RunnableParallel</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">chain1 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> ChatPromptTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_template</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"tell me a joke about {topic}"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> model</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">chain2 </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    ChatPromptTemplate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">from_template</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"write a short (2 line) poem about {topic}"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> model</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">combined </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> RunnableParallel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">joke</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">chain1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> poem</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain">chain2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div style="padding-top:1.3rem;background:var(--prism-background-color);color:var(--prism-color);margin-top:calc(-1 * var(--ifm-leading) - 5px);margin-bottom:var(--ifm-leading);box-shadow:var(--ifm-global-shadow-lw);border-bottom-left-radius:var(--ifm-code-border-radius);border-bottom-right-radius:var(--ifm-code-border-radius)"><h4 style="padding-left:0.65rem;margin-bottom:0.45rem">API Reference:</h4><ul style="padding-bottom:1rem"><li><a href="https://api.python.langchain.com/en/latest/runnables/langchain_core.runnables.base.RunnableParallel.html"><span>RunnableParallel</span></a></li></ul></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain">time</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">chain1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">invoke</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">CPU times: user 18 ms, sys: 1.27 ms, total: 19.3 ms</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Wall time: 692 ms</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">AIMessage(content="Why don't bears wear shoes?\n\nBecause they already have bear feet!")</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain">time</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">chain2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">invoke</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">CPU times: user 10.5 ms, sys: 166 ¬µs, total: 10.7 ms</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Wall time: 579 ms</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">AIMessage(content="In forest's embrace,\nMajestic bears pace.")</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain">time</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">combined</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">invoke</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">CPU times: user 32 ms, sys: 2.59 ms, total: 34.6 ms</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Wall time: 816 ms</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">{'joke': AIMessage(content="Sure, here's a bear-related joke for you:\n\nWhy did the bear bring a ladder to the bar?\n\nBecause he heard the drinks were on the house!"),</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> 'poem': AIMessage(content="In wilderness they roam,\nMajestic strength, nature's throne.")}</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="parallelism-on-batches">Parallelism on batches<a aria-label="Direct link to Parallelism on batches" class="hash-link" href="#parallelism-on-batches" title="Direct link to Parallelism on batches">‚Äã</a></h3><p>Parallelism can be combined with other runnables.
Let's try to use parallelism with batches.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain">time</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">chain1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">batch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"cats"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">CPU times: user 17.3 ms, sys: 4.84 ms, total: 22.2 ms</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Wall time: 628 ms</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[AIMessage(content="Why don't bears wear shoes?\n\nBecause they have bear feet!"),</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> AIMessage(content="Why don't cats play poker in the wild?\n\nToo many cheetahs!")]</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain">time</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">chain2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">batch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"cats"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">CPU times: user 15.8 ms, sys: 3.83 ms, total: 19.7 ms</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Wall time: 718 ms</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[AIMessage(content='In the wild, bears roam,\nMajestic guardians of ancient home.'),</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> AIMessage(content='Whiskers grace, eyes gleam,\nCats dance through the moonbeam.')]</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-python codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain">time</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">combined</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">batch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"bears"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token string" style="color:rgb(163, 21, 21)">"topic"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"cats"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">CPU times: user 44.8 ms, sys: 3.17 ms, total: 48 ms</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">Wall time: 721 ms</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div><div class="language-output codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#F5F5F5"><div class="codeBlockContent_biex"><pre class="prism-code language-output codeBlock_bY9V thin-scrollbar" tabindex="0"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">[{'joke': AIMessage(content="Sure, here's a bear joke for you:\n\nWhy don't bears wear shoes?\n\nBecause they have bear feet!"),</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'poem': AIMessage(content="Majestic bears roam,\nNature's strength, beauty shown.")},</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain"> {'joke': AIMessage(content="Why don't cats play poker in the wild?\n\nToo many cheetahs!"),</span><br/></span><span class="token-line" style="color:#000000"><span class="token plain">  'poem': AIMessage(content="Whiskers dance, eyes aglow,\nCats embrace the night's gentle flow.")}]</span><br/></span></code></pre><div class="buttonGroup__atx"><button aria-label="Copy code to clipboard" class="clean-btn" title="Copy" type="button"><span aria-hidden="true" class="copyButtonIcons_eSgA"><svg class="copyButtonIcon_y97N" viewbox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" fill="currentColor"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewbox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" fill="currentColor"></path></svg></span></button></div></div></div></div><div style="display:flex;flex-direction:column"><hr/><h4>Help us out by providing feedback on this documentation page:</h4><div style="display:flex;gap:5px"><div role="button" style="display:flex;align-items:center;padding-top:10px;padding-bottom:10px;padding-left:22px;padding-right:22px;border:1px solid gray;border-radius:6px;gap:10px;cursor:pointer;font-size:16px;font-weight:600" tabindex="0"><svg fill="none" stroke="#166534" stroke-width="1.5" style="width:24px;height:24px" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H14.25M5.904 18.5c.083.205.173.405.27.602.197.4-.078.898-.523.898h-.908c-.889 0-1.713-.518-1.972-1.368a12 12 0 0 1-.521-3.507c0-1.553.295-3.036.831-4.398C3.387 9.953 4.167 9.5 5 9.5h1.053c.472 0 .745.556.5.96a8.958 8.958 0 0 0-1.302 4.665c0 1.194.232 2.333.654 3.375Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></div><div role="button" style="display:flex;align-items:center;padding-top:10px;padding-bottom:10px;padding-left:22px;padding-right:22px;border:1px solid gray;border-radius:6px;gap:10px;cursor:pointer;font-size:16px;font-weight:600" tabindex="0"><svg fill="none" stroke="#991b1b" stroke-width="1.5" style="width:24px;height:24px" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.498 15.25H4.372c-1.026 0-1.945-.694-2.054-1.715a12.137 12.137 0 0 1-.068-1.285c0-2.848.992-5.464 2.649-7.521C5.287 4.247 5.886 4 6.504 4h4.016a4.5 4.5 0 0 1 1.423.23l3.114 1.04a4.5 4.5 0 0 0 1.423.23h1.294M7.498 15.25c.618 0 .991.724.725 1.282A7.471 7.471 0 0 0 7.5 19.75 2.25 2.25 0 0 0 9.75 22a.75.75 0 0 0 .75-.75v-.633c0-.573.11-1.14.322-1.672.304-.76.93-1.33 1.653-1.715a9.04 9.04 0 0 0 2.86-2.4c.498-.634 1.226-1.08 2.032-1.08h.384m-10.253 1.5H9.7m8.075-9.75c.01.05.027.1.05.148.593 1.2.925 2.55.925 3.977 0 1.487-.36 2.89-.999 4.125m.023-8.25c-.076-.365.183-.75.575-.75h.908c.889 0 1.713.518 1.972 1.368.339 1.11.521 2.287.521 3.507 0 1.553-.295 3.036-.831 4.398-.306.774-1.086 1.227-1.918 1.227h-1.053c-.472 0-.745-.556-.5-.96a8.95 8.95 0 0 0 .303-.54" stroke-linecap="round" stroke-linejoin="round"></path></svg></div></div></div></article><nav aria-label="Docs pages" class="pagination-nav docusaurus-mt-lg"><a class="pagination-nav__link pagination-nav__link--prev" href="/v0.1/docs/expression_language/get_started/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Get started</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v0.1/docs/expression_language/primitives/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Primitives</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="#input-schema">Input Schema</a></li><li><a class="table-of-contents__link toc-highlight" href="#output-schema">Output Schema</a></li><li><a class="table-of-contents__link toc-highlight" href="#stream">Stream</a></li><li><a class="table-of-contents__link toc-highlight" href="#invoke">Invoke</a></li><li><a class="table-of-contents__link toc-highlight" href="#batch">Batch</a></li><li><a class="table-of-contents__link toc-highlight" href="#async-stream">Async Stream</a></li><li><a class="table-of-contents__link toc-highlight" href="#async-invoke">Async Invoke</a></li><li><a class="table-of-contents__link toc-highlight" href="#async-batch">Async Batch</a></li><li><a class="table-of-contents__link toc-highlight" href="#async-stream-events-beta">Async Stream Events (beta)</a><ul><li><a class="table-of-contents__link toc-highlight" href="#event-reference">Event Reference</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="#async-stream-intermediate-steps">Async Stream Intermediate Steps</a><ul><li><a class="table-of-contents__link toc-highlight" href="#streaming-jsonpatch-chunks">Streaming JSONPatch chunks</a></li><li><a class="table-of-contents__link toc-highlight" href="#streaming-the-incremental-runstate">Streaming the incremental RunState</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="#parallelism">Parallelism</a><ul><li><a class="table-of-contents__link toc-highlight" href="#parallelism-on-batches">Parallelism on batches</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://discord.gg/cU2adEyC7w" rel="noopener noreferrer" target="_blank">Discord<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://twitter.com/LangChainAI" rel="noopener noreferrer" target="_blank">Twitter<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">GitHub</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://github.com/langchain-ai/langchain" rel="noopener noreferrer" target="_blank">Python<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://github.com/langchain-ai/langchainjs" rel="noopener noreferrer" target="_blank">JS/TS<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://langchain.com" rel="noopener noreferrer" target="_blank">Homepage<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://blog.langchain.dev" rel="noopener noreferrer" target="_blank">Blog<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="https://www.youtube.com/@LangChain" rel="noopener noreferrer" target="_blank">YouTube<svg aria-hidden="true" class="iconExternalLink_nPIU" height="13.5" viewbox="0 0 24 24" width="13.5"><path d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z" fill="currentColor"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2024 LangChain, Inc.</div></div></div></footer></div>
<script src="/v0.1/assets/js/runtime~main.1b0b4a9b.js"></script>
<script src="/v0.1/assets/js/main.1470d8ce.js"></script>
</body>
</html>